<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>eofs.multivariate.standard &#8212; eofs 2.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx13.css?v=84d1f121" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <script src="../_static/documentation_options.js?v=51b770b3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="eofs.multivariate.iris" href="eofs.multivariate.iris.html" />
    <link rel="prev" title="eofs.tools" href="eofs.tools.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
     
        <style type="text/css">
            table.right { float: right; margin-left: 20px; }
            table.right td { border: 1px solid #ccc; }
        </style>
        <script type="text/javascript">
            // intelligent scrolling of the sidebar content
            $(window).scroll(function() {
                var sb = $('.sphinxsidebarwrapper');
                var win = $(window);
                var sbh = sb.height();
                var offset = $('.sphinxsidebar').position()['top'];
                var wintop = win.scrollTop();
                var winbot = wintop + win.innerHeight();
                var curtop = sb.position()['top'];
                var curbot = curtop + sbh;
                // does sidebar fit in window?
                if (sbh < win.innerHeight()) {
                    // yes: easy case -- always keep at the top
                    sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                         $(document).height() - sbh - 200]));
                } else {
                    // no: only scroll if top/bottom edge of sidebar is at
                    // top/bottom edge of window
                    if (curtop > wintop && curbot > winbot) {
                        sb.css('top', $u.max([wintop - offset - 10, 0]));
                    } else if (curtop < wintop && curbot < winbot) {
                        sb.css('top', $u.min([winbot - sbh - offset - 20,
                                             $(document).height() - sbh - 200]));
                    }
                }
            });
        </script>

  </head><body>
<div class="pageheader">
  <div>
    <a href="../index.html">
      <img src="../_static/eofsheader.png" alt="SPHINX" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="eofs.multivariate.iris.html" title="eofs.multivariate.iris"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="eofs.tools.html" title="eofs.tools"
             accesskey="P">previous</a> |</li>
    <li><a href="../index.html">home</a>|&nbsp;</li>
    <li><a href="../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">API references</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">eofs.multivariate.standard</span></code></a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">

    <h2>eofs v2.0.0</h2>
    <h3>Table of Contents</h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API references</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#available-eof-solvers">Available EOF solvers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#full-documentation">Full documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devguide/index.html">Developer Guide</a></li>
</ul>


  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="eofs.tools.html"
                          title="previous chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eofs.tools</span></code></a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="eofs.multivariate.iris.html"
                          title="next chapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eofs.multivariate.iris</span></code></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/eofs.multivariate.standard.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
  
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-eofs.multivariate.standard">
<span id="eofs-multivariate-standard"></span><h1><a class="reference internal" href="#module-eofs.multivariate.standard" title="eofs.multivariate.standard"><code class="xref py py-mod docutils literal notranslate"><span class="pre">eofs.multivariate.standard</span></code></a><a class="headerlink" href="#module-eofs.multivariate.standard" title="Link to this heading">¶</a></h1>
<p>Multivariate EOF analysis for <a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> array data.</p>
<dl class="py class">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eofs.multivariate.standard.</span></span><span class="sig-name descname"><span class="pre">MultivariateEof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof" title="Link to this definition">¶</a></dt>
<dd><p>Multivariate EOF analysis (<a class="reference external" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code></a> interface)</p>
<p>Create a MultivariateEof instance.</p>
<p>The EOF solution is computed at initialization time. Method
calls are used to retrieve computed quantities.</p>
<p><strong>Arguments:</strong></p>
<dl class="simple">
<dt><em>datasets</em></dt><dd><p>A list/tuple containing one or more <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> or
<a class="reference external" href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ma.MaskedArray</span></code></a> objects, each with two or more
dimensions, containing the data to be analysed. The first
dimension of each array is assumed to represent time.
Missing values are permitted, either in the
form of masked arrays, or <a class="reference external" href="https://numpy.org/doc/stable/reference/constants.html#numpy.nan" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.nan</span></code></a> values. Missing values
must be constant with time in each field (e.g., values of an
oceanographic field over land).</p>
</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl>
<dt><em>weights</em></dt><dd><p>A sequence of arrays of weights whose shapes are compatible
with those of the input arrays in <em>datasets</em>, one array for
each array in <em>datasets</em>. The weights can have the same
shape as the corresponding array in <em>datasets</em> or a shape
compatible with an array broadcast operation (i.e., the
shape of the weights can match the rightmost parts of the
shape of the corresponding array in <em>datasets</em>). The value
<em>None</em> indicates that the corresponding array in <em>datasets</em>
should not be weighted. If none of the input data sets
require weighting then the single value <em>None</em> may be used.
Defaults to <em>None</em> (no weighting for any data set).</p>
</dd>
<dt><em>center</em></dt><dd><p>If <em>True</em>, the mean along the first axis of each array in
<em>datasets</em> (the time-mean) will be removed prior to
analysis. If <em>False</em>, the mean along the first axis will not
be removed. Defaults to <em>True</em> (mean is removed).</p>
<p>The covariance interpretation relies on the input data being
anomaly data with a time-mean of 0. Therefore this option
should usually be set to <em>True</em>. Setting this option to
<em>True</em> has the useful side effect of propagating missing
values along the time dimension, ensuring that a solution
can be found even if missing values occur in different
locations at different times.</p>
</dd>
<dt><em>ddof</em></dt><dd><p>‘Delta degrees of freedom’. The divisor used to normalize
the covariance matrix is <em>N - ddof</em> where <em>N</em> is the
number of samples. Defaults to <em>1</em>.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>solver</em></dt><dd><p>An <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> instance.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>EOF analysis of three variables with no weighting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">eofs.multivariate.standard</span> <span class="kn">import</span> <span class="n">MultivariateEof</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">MultivariateEof</span><span class="p">([</span><span class="n">olr</span><span class="p">,</span> <span class="n">u200</span><span class="p">,</span> <span class="n">u850</span><span class="p">])</span>
</pre></div>
</div>
<p>EOF analysis of two variables, one without weighting and one
with. In this example the data arrays are dimensioned
(ntime, nlat, nlon), and in order for the latitude weights used
for the second array to be broadcastable to this shape, an extra
length-1 dimension is added to the end:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">eofs.multivariate.standard</span> <span class="kn">import</span> <span class="n">MultivariateEof</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">latitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">73</span><span class="p">)</span>
<span class="n">weights_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">latitude</span><span class="p">)))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">MultivariateEof</span><span class="p">([</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">],</span>
                          <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights_array</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.neofs">
<span class="sig-name descname"><span class="pre">neofs</span></span><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.neofs" title="Link to this definition">¶</a></dt>
<dd><p>Number of EOFs in the solution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.pcs">
<span class="sig-name descname"><span class="pre">pcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pcscaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.pcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.pcs" title="Link to this definition">¶</a></dt>
<dd><p>Principal component time series (PCs).</p>
<p><strong>Optional arguments:</strong></p>
<dl class="simple">
<dt><em>pcscaling</em></dt><dd><p>Set the scaling of the retrieved PCs. The following
values are accepted:</p>
<ul class="simple">
<li><p><em>0</em> : Un-scaled PCs (default).</p></li>
<li><p><em>1</em> : PCs are scaled to unit variance (divided by the
square-root of their eigenvalue).</p></li>
<li><p><em>2</em> : PCs are multiplied by the square-root of their
eigenvalue.</p></li>
</ul>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>pcs</em></dt><dd><p>An array where the columns are the ordered PCs.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>All un-scaled PCs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcs</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">pcs</span><span class="p">()</span>
</pre></div>
</div>
<p>First 3 PCs scaled to unit variance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pcs</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">pcs</span><span class="p">(</span><span class="n">npcs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pcscaling</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.eofs">
<span class="sig-name descname"><span class="pre">eofs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eofscaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neofs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.eofs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.eofs" title="Link to this definition">¶</a></dt>
<dd><p>Empirical orthogonal functions (EOFs).</p>
<p><strong>Optional arguments:</strong></p>
<dl class="simple">
<dt><em>eofscaling</em></dt><dd><p>Sets the scaling of the EOFs. The following values are
accepted:</p>
<ul class="simple">
<li><p><em>0</em> : Un-scaled EOFs (default).</p></li>
<li><p><em>1</em> : EOFs are divided by the square-root of their
eigenvalues.</p></li>
<li><p><em>2</em> : EOFs are multiplied by the square-root of their
eigenvalues.</p></li>
</ul>
</dd>
<dt><em>neofs</em></dt><dd><p>Number of EOFs to return. Defaults to all EOFs. If the
number of EOFs requested is more than the number that are
available, then all available EOFs will be returned.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>eofs_list</em></dt><dd><p>A list of arrays containing the ordered EOFs for each
variable along the first dimension.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>All EOFs with no scaling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eofs_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofs</span><span class="p">()</span>
</pre></div>
</div>
<p>The leading EOF with scaling applied:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eof1_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofs</span><span class="p">(</span><span class="n">neofs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eofscaling</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.eofsAsCorrelation">
<span class="sig-name descname"><span class="pre">eofsAsCorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neofs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.eofsAsCorrelation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.eofsAsCorrelation" title="Link to this definition">¶</a></dt>
<dd><p>Empirical orthogonal functions (EOFs) expressed as the
correlation between the principal component time series (PCs)
and the each data set in the <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> input <em>datasets</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These are not related to the EOFs computed from the
correlation matrix.</p>
</div>
<p><strong>Optional argument:</strong></p>
<dl class="simple">
<dt><em>neofs</em></dt><dd><p>Number of EOFs to return. Defaults to all EOFs. If the
number of EOFs requested is more than the number that are
available, then all available EOFs will be returned.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>eofs_list</em></dt><dd><p>A list of arrays containing the ordered EOFs for each
variable along the first dimension.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>All EOFs of each data set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eofs_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofsAsCorrelation</span><span class="p">()</span>
</pre></div>
</div>
<p>The leading EOF of each data set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eof1_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofsAsCorrelation</span><span class="p">(</span><span class="n">neofs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.eofsAsCovariance">
<span class="sig-name descname"><span class="pre">eofsAsCovariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neofs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcscaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.eofsAsCovariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.eofsAsCovariance" title="Link to this definition">¶</a></dt>
<dd><p>Empirical orthogonal functions (EOFs) expressed as the
covariance between the principal component time series (PCs)
and the each data set in the <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> input <em>datasets</em>.</p>
<p><strong>Optional argument:</strong></p>
<dl>
<dt><em>neofs</em></dt><dd><p>Number of EOFs to return. Defaults to all EOFs. If the
number of EOFs requested is more than the number that are
available, then all available EOFs will be returned.</p>
</dd>
<dt><em>pcscaling</em></dt><dd><p>Set the scaling of the PCs used to compute covariance. The
following values are accepted:</p>
<ul class="simple">
<li><p><em>0</em> : Un-scaled PCs.</p></li>
<li><p><em>1</em> : PCs are scaled to unit variance (divided by the
square-root of their eigenvalue) (default).</p></li>
<li><p><em>2</em> : PCs are multiplied by the square-root of their
eigenvalue.</p></li>
</ul>
<p>The default is to divide PCs by the square-root of their
eigenvalue so that the PCs are scaled to unit variance
(option 1).</p>
</dd>
<dt><em>npcs</em></dt><dd><p>Number of PCs to retrieve. Defaults to all the PCs. If the
number of PCs requested is more than the number that are
available, then all available PCs will be returned.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>eofs_list</em></dt><dd><p>A list of arrays containing the ordered EOFs for each
variable along the first dimension.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>All EOFs of each data set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eofs_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofsAsCovariance</span><span class="p">()</span>
</pre></div>
</div>
<p>The leading EOF of each data set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eof1_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eofsAsCovariance</span><span class="p">(</span><span class="n">neofs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.eigenvalues">
<span class="sig-name descname"><span class="pre">eigenvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.eigenvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.eigenvalues" title="Link to this definition">¶</a></dt>
<dd><p>Eigenvalues (decreasing variances) associated with each EOF
mode.</p>
<p>Returns the eigenvalues in an array.</p>
<p><strong>Optional argument:</strong></p>
<dl class="simple">
<dt><em>neigs</em></dt><dd><p>Number of eigenvalues to return. Defaults to all
eigenvalues. If the number of eigenvalues requested is more
than the number that are available, then all available
eigenvalues will be returned.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>eigenvalues</em></dt><dd><p>An array containing the eigenvalues arranged largest to
smallest.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>All eigenvalues:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
</pre></div>
</div>
<p>The first eigenvalue:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eigenvalue1</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">neigs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.varianceFraction">
<span class="sig-name descname"><span class="pre">varianceFraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.varianceFraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.varianceFraction" title="Link to this definition">¶</a></dt>
<dd><p>Fractional EOF mode variances.</p>
<p>The fraction of the total variance explained by each EOF mode,
values between 0 and 1 inclusive.</p>
<p><strong>Optional argument:</strong></p>
<dl class="simple">
<dt><em>neigs</em></dt><dd><p>Number of eigenvalues to return the fractional variance for.
Defaults to all eigenvalues. If the number of eigenvalues
requested is more than the number that are available, then
fractional variances for all available eigenvalues will be
returned.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>variance_fractions</em></dt><dd><p>An array containing the fractional variances.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>The fractional variance represented by each EOF mode:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">variance_fraction</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">varianceFraction</span><span class="p">()</span>
</pre></div>
</div>
<p>The fractional variance represented by the first EOF mode:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">variance_fraction_mode_1</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">VarianceFraction</span><span class="p">(</span><span class="n">neigs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.totalAnomalyVariance">
<span class="sig-name descname"><span class="pre">totalAnomalyVariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.totalAnomalyVariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.totalAnomalyVariance" title="Link to this definition">¶</a></dt>
<dd><p>Total variance associated with the field of anomalies (the sum
of the eigenvalues).</p>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>total_variance</em></dt><dd><p>A scalar value.</p>
</dd>
</dl>
<p><strong>Example:</strong></p>
<p>Get the total variance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">total_variance</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">totalAnomalyVariance</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.northTest">
<span class="sig-name descname"><span class="pre">northTest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vfscaled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.northTest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.northTest" title="Link to this definition">¶</a></dt>
<dd><p>Typical errors for eigenvalues.</p>
<p>The method of North et al. (1982) is used to compute the typical
error for each eigenvalue. It is assumed that the number of
times in the input data set is the same as the number of
independent realizations. If this assumption is not valid then
the result may be inappropriate.</p>
<p><strong>Optional arguments:</strong></p>
<dl class="simple">
<dt><em>neigs</em></dt><dd><p>The number of eigenvalues to return typical errors for.
Defaults to typical errors for all eigenvalues. If the
number of eigenvalues requested is more than the number that
are available, then typical errors for all available
eigenvalues will be returned.</p>
</dd>
<dt><em>vfscaled</em></dt><dd><p>If <em>True</em> scale the errors by the sum of the eigenvalues.
This yields typical errors with the same scale as the values
returned by <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof.varianceFraction" title="eofs.multivariate.standard.MultivariateEof.varianceFraction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof.varianceFraction</span></code></a>. If <em>False</em>
then no scaling is done. Defaults to <em>False</em> (no scaling).</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>errors</em></dt><dd><p>An array containing the typical errors.</p>
</dd>
</dl>
<p><strong>References</strong></p>
<p>North G.R., T.L. Bell, R.F. Cahalan, and F.J. Moeng (1982)
Sampling errors in the estimation of empirical orthogonal
functions. <em>Mon. Weather. Rev.</em>, <strong>110</strong>, pp 669-706.</p>
<p><strong>Examples:</strong></p>
<p>Typical errors for all eigenvalues:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">northTest</span><span class="p">()</span>
</pre></div>
</div>
<p>Typical errors for the first 5 eigenvalues scaled by the sum of
the eigenvalues:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">northTest</span><span class="p">(</span><span class="n">neigs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">vfscaled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.reconstructedField">
<span class="sig-name descname"><span class="pre">reconstructedField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neofs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.reconstructedField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.reconstructedField" title="Link to this definition">¶</a></dt>
<dd><p>Reconstructed data sets based on a subset of EOFs.</p>
<p>If weights were passed to the <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> instance the
returned reconstructed fields will automatically have this
weighting removed. Otherwise each returned field will have the
same weighting as the corresponding  array in the
<a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> input <em>datasets</em>.</p>
<p><strong>Argument:</strong></p>
<dl class="simple">
<dt><em>neofs</em></dt><dd><p>Number of EOFs to use for the reconstruction. If the
number of EOFs requested is more than the number that are
available, then all available EOFs will be used for the
reconstruction. Alternatively this argument can be an
iterable of mode numbers (where the first mode is 1) in
order to facilitate reconstruction with arbitrary modes.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>reconstruction_list</em></dt><dd><p>A list of arrays with the same shapes as the arrays in the
<a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> input <em>datasets</em> contaning the
reconstructions using <em>neofs</em> EOFs.</p>
</dd>
</dl>
<p><strong>Example:</strong></p>
<p>Reconstruct the input data sets using 3 EOFs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reconstruction_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">reconstructedField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Reconstruct the input field using EOFs 1, 2 and 5:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reconstruction_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">reconstuctedField</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.projectField">
<span class="sig-name descname"><span class="pre">projectField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neofs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eofscaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.projectField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.projectField" title="Link to this definition">¶</a></dt>
<dd><p>Project a set of fields onto the EOFs.</p>
<p>Given a set of data sets, projects them onto the EOFs to
generate a corresponding set of pseudo-PCs.</p>
<p><strong>Argument:</strong></p>
<dl class="simple">
<dt><em>fields</em></dt><dd><p>A list/tuple containing one or more <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> or
<a class="reference external" href="https://numpy.org/doc/stable/reference/maskedarray.baseclass.html#numpy.ma.MaskedArray" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ma.MaskedArray</span></code></a> objects, each with two or more
dimensions, containing the fields to be projected onto the
EOFs. Each field must have the same spatial dimensions
(including missing values in the same places) as the
corresponding data set in the <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> input
<em>datasets</em>. The data sets may have different length time
dimensions to the <a class="reference internal" href="#eofs.multivariate.standard.MultivariateEof" title="eofs.multivariate.standard.MultivariateEof"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultivariateEof</span></code></a> inputs <em>datasets</em> or no
time dimension at all, but this must be consistent for all
fields.</p>
</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="simple">
<dt><em>neofs</em></dt><dd><p>Number of EOFs to project onto. Defaults to all EOFs. If the
number of EOFs requested is more than the number that are
available, then the field will be projected onto all
available EOFs.</p>
</dd>
<dt><em>eofscaling</em></dt><dd><p>Set the scaling of the EOFs that are projected
onto. The following values are accepted:</p>
<ul class="simple">
<li><p><em>0</em> : Un-scaled EOFs (default).</p></li>
<li><p><em>1</em> : EOFs are divided by the square-root of their
eigenvalue.</p></li>
<li><p><em>2</em> : EOFs are multiplied by the square-root of their
eigenvalue.</p></li>
</ul>
</dd>
<dt><em>weighted</em></dt><dd><p>If <em>True</em> then each field in <em>fields</em> is weighted using the
same weights used for the EOF analysis prior to projection.
If <em>False</em> then no weighting is applied. Defaults to <em>True</em>
(weighting is applied). Generally only the default setting
should be used.</p>
</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>pseudo_pcs</em></dt><dd><p>An array where the columns are the ordered pseudo-PCs.</p>
</dd>
</dl>
<p><strong>Examples:</strong></p>
<p>Project a data set onto all EOFs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pseudo_pcs</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">projectField</span><span class="p">([</span><span class="n">field1</span><span class="p">,</span> <span class="n">field2</span><span class="p">])</span>
</pre></div>
</div>
<p>Project a data set onto the four leading EOFs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pseudo_pcs</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">projectField</span><span class="p">([</span><span class="n">field1</span><span class="p">,</span> <span class="n">field2</span><span class="p">],</span> <span class="n">neofs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eofs.multivariate.standard.MultivariateEof.getWeights">
<span class="sig-name descname"><span class="pre">getWeights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/eofs/multivariate/standard.html#MultivariateEof.getWeights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#eofs.multivariate.standard.MultivariateEof.getWeights" title="Link to this definition">¶</a></dt>
<dd><p>Weights used for the analysis.</p>
<p><strong>Returns:</strong></p>
<dl class="simple">
<dt><em>weights_list</em></dt><dd><p>A list of arrays containing the analysis weights for each
variable.</p>
</dd>
</dl>
<p><strong>Example:</strong></p>
<p>The weights used for the analysis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">weights_list</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">getWeights</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <script type=text/javascript src="/eofs/version_switch.js" async></script>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="eofs.multivariate.iris.html" title="eofs.multivariate.iris"
             >next</a> |</li>
        <li class="right" >
          <a href="eofs.tools.html" title="eofs.tools"
             >previous</a> |</li>
    <li><a href="../index.html">home</a>|&nbsp;</li>
    <li><a href="../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >API references</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><code class="xref py py-mod docutils literal notranslate"><span class="pre">eofs.multivariate.standard</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2013-2024 Andrew Dawson.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>